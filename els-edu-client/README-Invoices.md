# Invoice Management System\n\nThis document describes the Invoice management feature integrated into the React-Admin application.\n\n## Overview\n\nThe Invoice system allows you to:\n- Create and manage invoices for organizations and users\n- Track different payment statuses (Draft, Sent, Paid, Overdue)\n- Handle both course and subject-based billing\n- Generate line items with automatic tax calculations\n- Print and export invoices\n\n## Features Implemented\n\n### 1. Data Model\n\n**Invoice Structure:**\n```javascript\n{\n  id: string|number,\n  number: string,              // e.g., INV-2025-000123\n  date: string,                // ISO date\n  dueDate: string,             // ISO date\n  status: \"draft\"|\"sent\"|\"paid\"|\"overdue\",\n  subtotal: number,\n  tax: number,                 // 18% GST for INR\n  discount: number,\n  total: number,\n  currency: \"INR\"|\"USD\",\n  targetType: \"ORG\"|\"USER\",\n  targetId: string|number,\n  targetName: string,\n  categoryType: \"course\"|\"subject\",\n  categoryId: string|number,\n  categoryName: string,\n  lineItems: [\n    { \n      description: string, \n      quantity: number, \n      unitPrice: number, \n      subjectOrCourseId?: string|number \n    }\n  ],\n  notes?: string,\n  createdAt: string, \n  updatedAt: string\n}\n```\n\n### 2. UI Components\n\n#### List View (`/invoices`)\n- **Columns**: Invoice number, client name, category, dates, status chips, total amount\n- **Filters**: Status, target type, category type, date range\n- **Sorting**: By date, due date, total amount\n- **Actions**: Create, export, view details\n\n#### Show View (`/invoices/{id}`)\n- **Header**: Invoice number, status, dates, total\n- **Billing Info**: Client details and category information\n- **Line Items**: Detailed table with quantities and calculations\n- **Summary**: Subtotal, tax, discount, and total breakdown\n- **Actions**: Print, download JSON, edit, delete\n\n#### Create/Edit Forms\n- **Basic Info**: Invoice number (auto-generated), dates, status\n- **Client Selection**: Type (ORG/USER) with autocomplete for names\n- **Category Selection**: Type (course/subject) with autocomplete\n- **Line Items**: Dynamic array with description, quantity, unit price\n- **Auto Calculations**: Subtotal, 18% GST tax, final total\n- **Validation**: Required fields and business rules\n\n### 3. Status Management\n\nStatus chips with color coding:\n- **Draft**: Gray (default)\n- **Sent**: Blue (info)\n- **Paid**: Green (success) \n- **Overdue**: Red (error)\n\n### 4. Currency Support\n\n- **INR**: Indian Rupee with \"en-IN\" locale formatting\n- **USD**: US Dollar with \"en-US\" locale formatting\n- Automatic GST calculation (18%) for INR invoices\n\n## File Structure\n\n```\nsrc/\n├── features/invoices/\n│   ├── List.jsx              # Invoice list with filters\n│   ├── Show.jsx              # Invoice details view\n│   ├── Create.jsx            # Create new invoice\n│   ├── Edit.jsx              # Edit existing invoice\n│   ├── StatusChip.jsx        # Status display component\n│   ├── LineItemsTable.jsx    # Line items display\n│   ├── filters.jsx           # Filter components\n│   ├── types.ts              # TypeScript interfaces\n│   └── index.js              # Feature exports\n├── data/\n│   ├── fixtures/\n│   │   ├── invoices.json     # Sample invoice data\n│   │   ├── orgs.json         # Sample organizations\n│   │   ├── users.json        # Sample users\n│   │   ├── courses.json      # Sample courses\n│   │   └── subjects.json     # Sample subjects\n│   ├── mockInvoiceProvider.js # Mock data provider\n│   └── compositeDataProvider.js # Routes to mock/real APIs\n├── utils/\n│   └── currency.ts           # Currency formatting helpers\n└── layouts/\n    └── Menu.jsx              # Updated with Invoices menu item\n```\n\n## Sample Data\n\nThe system includes 8 sample invoices with varied:\n- **Clients**: Mix of organizations and individual users\n- **Categories**: Both courses and subjects\n- **Statuses**: All four status types represented\n- **Amounts**: Range from ₹9,440 to ₹83,500\n- **Line Items**: Different quantities and pricing structures\n\n## Current Implementation: Mock Data\n\nThe invoices feature currently uses **mock data** stored in JSON fixtures for demonstration purposes. This allows for:\n\n✅ **Complete CRUD operations** (Create, Read, Update, Delete)\n✅ **Filtering and sorting** functionality\n✅ **In-memory data persistence** during the session\n✅ **Realistic data relationships** between entities\n✅ **Full UI testing** without backend dependencies\n\n## Switching to Real API\n\nTo connect to a real backend API, follow these steps:\n\n### 1. Update Data Provider\n\nEdit `src/data/compositeDataProvider.js`:\n\n```javascript\n// Remove invoice-related resources from mock list\nconst MOCK_RESOURCES = []; // Remove 'invoices', 'orgs', 'users', 'courses', 'subjects'\n\n// Or create a dedicated invoice API provider\nimport { jsonServerProvider } from 'ra-data-json-server';\nconst invoiceApiProvider = jsonServerProvider('http://your-api-url');\n```\n\n### 2. API Endpoints Required\n\nImplement these RESTful endpoints:\n\n```\nGET    /api/invoices              # List invoices with filters\nGET    /api/invoices/{id}         # Get single invoice\nPOST   /api/invoices              # Create invoice\nPUT    /api/invoices/{id}         # Update invoice\nDELETE /api/invoices/{id}         # Delete invoice\n\n# Reference data endpoints\nGET    /api/orgs                  # List organizations\nGET    /api/users                 # List users\nGET    /api/courses               # List courses  \nGET    /api/subjects              # List subjects\n```\n\n### 3. Update AutocompleteInput Sources\n\nIn `Create.jsx` and `Edit.jsx`, update the autocomplete inputs:\n\n```jsx\n// Change from resource names to actual API endpoints\n<AutocompleteInput\n  source=\"targetName\"\n  label=\"Client Name\"\n  reference={targetType === 'ORG' ? 'orgs' : 'users'}  // Use reference prop\n  optionText=\"name\"\n  validate={required()}\n  fullWidth\n/>\n```\n\n### 4. Authentication Integration\n\nThe existing Strapi authentication will automatically apply to invoice API calls once you switch to the real provider.\n\n### 5. Field Mapping\n\nEnsure your API response format matches the expected structure, or create transform functions in the data provider.\n\n## Keyboard Accessibility\n\nAll forms include:\n- **Tab navigation** through form fields\n- **Aria labels** on inputs and buttons\n- **Focus management** for modal dialogs\n- **Screen reader** compatible status announcements\n\n## Print Functionality\n\nThe Show view includes print optimization:\n- **Print CSS**: Hides action buttons and navigation\n- **Clean layout**: Optimized for paper format\n- **Full invoice details**: All information included in print\n\n## Technology Stack\n\n- **React-Admin v5**: Core framework\n- **Material-UI v5**: Component library\n- **Lucide React**: Icon library\n- **TypeScript**: Type definitions\n- **Tailwind CSS**: Utility styling\n\n## Next Steps\n\n1. **Connect to real API** following the guide above\n2. **Add PDF export** functionality\n3. **Implement email sending** for invoice delivery\n4. **Add payment tracking** integration\n5. **Create invoice templates** for customization\n6. **Add bulk operations** for multiple invoices\n\n## Support\n\nFor questions or issues with the invoice system, please refer to:\n- React-Admin documentation: https://marmelab.com/react-admin/\n- Material-UI documentation: https://mui.com/\n- This codebase's existing patterns for similar features\n"